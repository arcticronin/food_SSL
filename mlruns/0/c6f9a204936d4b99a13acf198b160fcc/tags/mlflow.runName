train loop 2_ version SSL